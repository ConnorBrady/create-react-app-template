var bIsShow=false;var Rect={x:0,y:0,w:0,h:0};var displayPos={x:0,y:0,w:200,h:100};var mouseover=function(e){e=e||window.event;var elem=e.target||e.srcElement;var videoContents=document.getElementsByClassName('video-stream');videoContent=videoContents[0];if(videoContent){var divStyle=videoContent.ownerDocument.defaultView.getComputedStyle(videoContent,null);var playRect={left:0,top:0,right:0,bottom:0};playRect.left=parseInt(videoContent.getBoundingClientRect().left+document.documentElement.scrollLeft);playRect.top=parseInt(videoContent.getBoundingClientRect().top+document.documentElement.scrollTop);playRect.right=parseInt(playRect.left+parseInt(divStyle.width));playRect.bottom=parseInt(playRect.top+parseInt(divStyle.height));var mousePos={x:0,y:0};mousePos.x=e.clientX;mousePos.y=e.clientY;if(mousePos.x>playRect.left&&mousePos.x<playRect.right&&mousePos.y>playRect.top&&mousePos.y<playRect.bottom){displayX=playRect.right;if(playRect.top<0){displayY=0;}else{displayY=playRect.top;}var pageUrl=document.URL;var title=document.title;var cookie=document.cookie;cookeie=cookie.substring(9);var videoUrl=videoContent.src;var bIsHtml5=true;browserX=e.screenX-e.clientX;browserY=e.screenY-e.clientY;ShowButton(displayX+browserX,displayY+browserY,pageUrl,title,cookie,videoUrl,bIsHtml5,parseInt(divStyle.width),parseInt(divStyle.height));bIsShow=true;return;}}if(elem.tagName.toLowerCase()!="embed"&&elem.tagName.toLowerCase()!="object"&&elem.tagName.toLowerCase()!="video"){return;}if(!elem.parentNode){return;}var elemStyles=elem.ownerDocument.defaultView.getComputedStyle(elem,null);var elemW=elemStyles.width;var elemH=elemStyles.height;var elemX=elem.getBoundingClientRect().left+document.documentElement.scrollLeft;var elemY=elem.getBoundingClientRect().top+document.documentElement.scrollTop;displayPos.x=elemX+parseInt(elemW);if(elemY<0){displayPos.y=0;}else{displayPos.y=elemY;}var title=document.title;var cookie=document.cookie;cookeie=cookie.substring(9);var pageUrl=document.URL;browserX=e.screenX-e.clientX;browserY=e.screenY-e.clientY;ShowButton(displayPos.x+browserX,displayPos.y+browserY,pageUrl,document.title,"","",false,parseInt(elemW),parseInt(elemH));};function isButtonPos(e,elem){var mousePos={x:0,y:0};mousePos.x=e.clientX;mousePos.y=e.clientY;var elemStyles=elem.ownerDocument.defaultView.getComputedStyle(elem,null);var ButtonRight=elem.getBoundingClientRect().left+document.documentElement.scrollLeft+parseInt(elemStyles.width);var ButtonBottom=elem.getBoundingClientRect().top+document.documentElement.scrollTop;var ButtonLeft=ButtonRight-134;var ButtonTop=ButtonBottom-29;if(mousePos.x>=ButtonLeft&&mousePos.x<=ButtonRight&&mousePos.y>=ButtonTop&&mousePos.y<=ButtonBottom)return true;return false;}var mouseout=function(e){e=e||window.event;var elem=e.target||e.srcElement;if(elem.tagName.toLowerCase()=="embed"||elem.tagName.toLowerCase()=="object"){pageUrl=document.URL;if(isButtonPos(e,elem))return;HideButton(pageUrl);return;}var videoContents=document.getElementsByClassName('video-stream');videoContent=videoContents[0];if(videoContent){pageUrl=document.URL;}};var mousemove=function(e){if(bIsShow==false)return;e=e||window.event;var elem=e.target||e.srcElement;if(elem.tagName.toLowerCase()=="embed"||elem.tagName.toLowerCase()=="object"){return;}};function ShowButton(x,y,pageUrl,title,cookie,videoUrl,bIsHtml5,w,h){Rect.x=x;Rect.y=y;Rect.w=w;Rect.h=h;chrome.extension.sendRequest({'action':'ShowButton','Rect':Rect,'pageUrl':pageUrl,'title':title,'cookie':cookie,'videoUrl':videoUrl,'bIsHtml5':bIsHtml5});}function HideButton(pageUrl){chrome.extension.sendRequest({'action':'HideButton','pageUrl':pageUrl});}var mousewheel=function(e){e=e||window.event;var elem=e.target||e.srcElement;if(elem.tagName.toLowerCase()=="embed"||elem.tagName.toLowerCase()=="object"){pageUrl=document.URL;HideButton(pageUrl);return;}var videoContents=document.getElementsByClassName('video-stream');videoContent=videoContents[0];if(videoContent){pageUrl=document.URL;}};var bind=function(e,t,fn){if(e.addEventListener){e.addEventListener(t,fn,false);}else if(e.attachEvent){e.attachEvent('on'+t,fn);}};var unbind=function(e,t,fn){if(e.removeEventListener){e.removeEventListener(t,fn,false);}else if(e.detachEvent){this.detachEvent('on'+t,fn);}};bind(document,'mouseover',mouseover);bind(document,'mouseout',mouseout);bind(document,'mousemove',mousemove);bind(document,'mousewheel',mousewheel);
